<!-- begin botlogo.html file -->
<!-- Rel 2009B Example Set -->
<!-- Updated: Sept 2009 -->
</div><!-- pageContent  -->
<div style="clear:both"></div>
</div><!-- innerContent -->
</div><!-- innerContentWrapper -->
</div><!-- allContent -->
<!-- end botlogo.html file -->
<!-- Google Book Search viewability API script for bib record-->

<script type='text/javascript'>

    var ProcessResults = function(bookInfo) {
        var buttonImg = "<img src='/screens/googlebutton.gif' alt='Google Preview'>"
        var textGBS = "";
        for (OCLC in bookInfo) {
	    alert("some text")
            var b = bookInfo[OCLC[0]];
            var googleButton = "<a href='" + b.preview_url + "' target='blank'>" + buttonImg;
            //form the text of Google Book contents
            if (b && (b.preview == "full")) {
                //textGBS = "Full Text";
                //"Google Book Search";
                document.getElementById("googlebooks").innerHTML = googleButton
            }
            else if (b && (b.preview == "partial")) {
                //textGBS = "(Limited preview)"
                //"Preview at Google Book Search";
                document.getElementById("googlebooks").innerHTML = googleButton
            }
            else {
                //document.getElementById("googlebooks").innerHTML = "None available.";
            }
    }
}
</script>


<script type='text/javascript'>

var OCLC = new Array();

$(".gbs").each(function(index) {
    OCLC.push($(this).text());

    var cburl = "http://books.google.com/books";
    // Retrieve the info for these bibkeys
    var api_url = cburl + "?jscmd=viewapi&bibkeys=OCLC:" + OCLC[index];
    var s = document.createElement("script");
    s.setAttribute("type", "text/javascript");
    //alert("searching for: " + OCLC);
    s.setAttribute("src", "http://books.google.com/books?jscmd=viewapi&bibkeys=OCLC:" + OCLC[index] + "&callback=ProcessResults");
    document.documentElement.firstChild.appendChild(s);
    //alert (api_url);

});     

</script>
